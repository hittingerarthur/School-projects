# -*- coding: utf-8 -*-



import numpy as np
import matplotlib.pyplot as plt
def donnees_TD4ex2():
    """ Fonction qui donne les données à traiter dans l'exercice 2 du TD4. 
    
    ----------------
    Utilisation : x,y=donnes_TD4ex2()
    """
    x=np.array([ 0.3, -2.7, -1.9,  1.2, -2.6,  2.7,  2. , -1.6, -0.5, -2.4])
    y=np.array([ 2.8, -9.4, -4.5,  3.8, -8. ,  3. ,  3.9, -3.5,  1.3, -7.6])
    return x,y


def donnees_partie2():
    """ Fonction qui donne les données à traiter dans la partie 2
    du TP4. 
    
    ----------------
    Utilisation : x,y=donnes_partie3()
    """
    
    x=np.array([ 3.58, -2.26,  1.17,  7.09,  1.3 , -4.82, -4.83,  1.53,  5.73,
       -3.44,  4.04,  2.99,  3.59, -4.66, -0.61,  0.67, -4.02, -1.91,
        6.58, -5.07,  5.18, -1.67, -2.6 ,  4.27,  4.  , -5.36, -2.1 ,
        5.94, -3.92, -3.29,  6.39,  2.04, -4.66,  7.73, -4.26,  4.26,
       -4.15, -4.67, -0.73, -4.8 ,  5.15, -2.9 ,  6.55,  5.7 ,  6.15,
        5.46,  0.1 , -2.46, -4.52,  7.01,  6.79, -0.04,  7.25, -2.01,
        7.07, -2.02, -4.57,  3.11,  1.01,  6.38, -4.69,  7.19, -4.22,
       -5.08,  6.9 ,  4.28, -3.31,  6.58, -1.71,  6.28, -3.9 ,  6.88,
       -3.76,  4.53,  6.31,  6.54,  7.17,  7.3 ,  6.38, -1.17, -0.22,
       -0.64,  3.91,  2.11,  1.66, -1.66, -4.1 ,  6.16,  7.54, -1.44,
        5.57,  4.85,  7.04, -4.64,  6.67, -4.93,  6.92, -3.11,  0.17,
        3.95])

    y=np.array([-6.71,  4.17, -6.94,  0.19, -6.9 , -2.03, -0.52,  5.14, -4.87,
       -4.94,  4.12,  4.99,  4.83,  0.78, -6.75, -7.3 , -4.05,  4.58,
       -3.26, -0.12,  4.38,  4.14, -5.99,  4.38, -6.41,  0.03, -6.2 ,
        3.04,  2.  ,  3.26,  2.53,  4.94, -2.35,  0.85, -4.18,  4.79,
        1.99, -2.74, -6.75, -2.97,  3.87, -5.26, -4.45,  3.87,  2.74,
       -5.24, -6.97,  4.07, -2.31, -0.11,  1.71, -7.01, -0.62, -5.79,
        0.82, -5.86,  1.87,  5.09, -7.09, -3.97, -2.9 , -2.3 , -4.63,
       -1.17,  0.86,  4.68,  3.23, -3.48, -6.54, -4.76,  2.55,  0.92,
        3.19,  3.97,  2.93, -3.28,  0.26, -2.52, -4.63, -6.4 ,  5.05,
       -6.75, -6.41,  5.18,  5.49,  4.13,  2.57,  2.58,  0.04,  4.8 ,
        3.59,  4.09,  1.15, -2.68,  1.24, -0.9 , -3.56,  3.29, -7.06,
        4.46])

    return x,y

x,y=donnees_partie2()
plt.scatter(x,y)
plt.show()

def verification(x,y):
    n=len(x)
    A=np.zeros((n,3))
    b=np.zeros(n)
    for i in range(n):
        A[i,0]=1
        A[i,1]=2*x[i]
        A[i,2]=2*y[i]
        b[i]=x[i]**2+y[i]**2
    return np.linalg.solve(A.T@A,A.T@b)

print(verification(x, y))